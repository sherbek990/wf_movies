<% if (banners && banners.length > 0) { %>
<section class="hero">
  <div class="hero-slider" id="heroSlider">
    <% banners.forEach(function(banner, index) { %>
      <div class="hero-slide <%= index === 0 ? 'active' : '' %>">
        <img src="<%= banner.image_url || 'https://via.placeholder.com/1920x800/1a1a1a/666?text=Banner' %>" alt="<%= banner.title %>" />
        <div class="hero-overlay"></div>
      </div>
    <% }); %>
  </div>
  
  <div class="hero-content">
    <span class="hero-badge">FEATURED</span>
    <h1 id="heroTitle"><%= banners[0].title %></h1>
    <div class="meta">
      <span class="rating">‚≠ê <%= banners[0].rating || '0.0' %></span>
      <span><%= banners[0].year || 'N/A' %></span>
      <span><%= banners[0].genre_name || banners[0].category %></span>
    </div>
    <p id="heroDesc"><%= (banners[0].description || 'No description available').slice(0, 200) %>...</p>
    <div class="hero-actions">
      <a class="btn primary" href="/watch/<%= banners[0].id %>">‚ñ∂ Watch Now</a>
      <a class="btn secondary" href="/watch/<%= banners[0].id %>">‚Ñπ More Info</a>
    </div>
  </div>
</section>
<% } else { %>
<section class="hero" style="background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%); height: 50vh;">
  <div class="hero-content" style="text-align: center; max-width: 700px; margin: 0 auto;">
    <h1>Welcome to WF Movies</h1>
    <p>Watch the latest movies, series and anime online in high quality</p>
    <div class="hero-actions" style="justify-content: center;">
      <a class="btn primary" href="/movies">Browse Movies</a>
      <a class="btn secondary" href="/register">Sign Up Free</a>
    </div>
  </div>
</section>
<% } %>

<!-- Latest Movies -->
<% if (latest && latest.length > 0) { %>
<section class="content-section">
  <div class="section-header">
    <div class="section-title">
      <span class="section-dot"></span>
      <h2>Latest Releases</h2>
    </div>
    <a href="/movies" class="view-all">View All ‚Üí</a>
  </div>
  
  <div class="movie-grid">
    <% latest.forEach(function(item) { %>
      <div class="movie-card">
        <div class="card-poster">
          <img src="<%= item.image_url || 'https://via.placeholder.com/300x450/1a1a1a/666?text=' + encodeURIComponent(item.title) %>" alt="<%= item.title %>" />
          <% if (item.rating && item.rating > 0) { %>
            <span class="card-badge">‚≠ê <%= item.rating %></span>
          <% } %>
        </div>
        <div class="card-info">
          <h3><%= item.title %></h3>
          <div class="card-meta">
            <span><%= item.year || 'N/A' %></span>
            <span><%= item.genre_name || item.category %></span>
          </div>
          <% if (item.description) { %>
            <p class="card-description"><%= item.description.slice(0, 80) %>...</p>
          <% } %>
          <a class="btn small primary" href="/watch/<%= item.id %>">‚ñ∂ Watch</a>
        </div>
      </div>
    <% }); %>
  </div>
</section>
<% } %>

<!-- Most Viewed -->
<% if (mostViewed && mostViewed.length > 0) { %>
<section class="content-section">
  <div class="section-header">
    <div class="section-title">
      <span class="section-dot"></span>
      <h2>Most Viewed</h2>
    </div>
    <a href="/movies" class="view-all">View All ‚Üí</a>
  </div>
  
  <div class="movie-grid">
    <% mostViewed.forEach(function(item) { %>
      <div class="movie-card">
        <div class="card-poster">
          <img src="<%= item.image_url || 'https://via.placeholder.com/300x450/1a1a1a/666?text=' + encodeURIComponent(item.title) %>" alt="<%= item.title %>" />
          <% if (item.views > 0) { %>
            <span class="card-badge">üëÅ <%= item.views %></span>
          <% } %>
        </div>
        <div class="card-info">
          <h3><%= item.title %></h3>
          <div class="card-meta">
            <span><%= item.year || 'N/A' %></span>
            <span><%= item.genre_name || item.category %></span>
          </div>
          <% if (item.description) { %>
            <p class="card-description"><%= item.description.slice(0, 80) %>...</p>
          <% } %>
          <a class="btn small primary" href="/watch/<%= item.id %>">‚ñ∂ Watch</a>
        </div>
      </div>
    <% }); %>
  </div>
</section>
<% } %>

<!-- Featured/Recommended -->
<% if (featured && featured.length > 0) { %>
<section class="content-section">
  <div class="section-header">
    <div class="section-title">
      <span class="section-dot"></span>
      <h2>Recommended For You</h2>
    </div>
    <a href="/movies" class="view-all">View All ‚Üí</a>
  </div>
  
  <div class="movie-grid">
    <% featured.forEach(function(item) { %>
      <div class="movie-card">
        <div class="card-poster">
          <img src="<%= item.image_url || 'https://via.placeholder.com/300x450/1a1a1a/666?text=' + encodeURIComponent(item.title) %>" alt="<%= item.title %>" />
          <% if (item.rating && item.rating > 0) { %>
            <span class="card-badge">‚≠ê <%= item.rating %></span>
          <% } %>
        </div>
        <div class="card-info">
          <h3><%= item.title %></h3>
          <div class="card-meta">
            <span><%= item.year || 'N/A' %></span>
            <span><%= item.genre_name || item.category %></span>
          </div>
          <% if (item.description) { %>
            <p class="card-description"><%= item.description.slice(0, 80) %>...</p>
          <% } %>
          <a class="btn small primary" href="/watch/<%= item.id %>">‚ñ∂ Watch</a>
        </div>
      </div>
    <% }); %>
  </div>
</section>
<% } %>

<% if (error) { %>
  <div class="content-section">
    <p class="error"><%= error %></p>
  </div>
<% } %>

<script>
  // Hero slider functionality
  const slides = document.querySelectorAll('.hero-slide');
  const banners = <%- JSON.stringify(banners || []) %>;
  let currentSlide = 0;

  if (slides.length > 1) {
    setInterval(() => {
      slides[currentSlide].classList.remove('active');
      currentSlide = (currentSlide + 1) % slides.length;
      slides[currentSlide].classList.add('active');
      
      // Update content
      if (banners[currentSlide]) {
        document.getElementById('heroTitle').textContent = banners[currentSlide].title;
        const desc = banners[currentSlide].description || 'No description available';
        document.getElementById('heroDesc').textContent = desc.slice(0, 200) + '...';
      }
    }, 5000);
  }
</script>
